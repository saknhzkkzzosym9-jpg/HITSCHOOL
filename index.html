<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>–§–µ–π–∫–æ–≤–∏–π –ñ—É—Ä–Ω–∞–ª</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; background: #fff; color: #222; }
  h1 { color: #333; }
  .toolbar { margin-bottom: 20px; }
  .scale-control { margin-bottom: 10px; }
  .month-table { border-collapse: collapse; width: 100%; font-size: 14px; margin-bottom: 20px; transition: transform 0.2s; transform-origin: left top; }
  .month-table th, .month-table td { border: 1px solid #ccc; text-align: center; padding: 5px; min-width: 45px; }
  .today { background: #c2f0c2 !important; } 
  .control { background: #e0d4f7 !important; } 
  .popup, .choicePopup { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
    background: #fff; padding: 20px; border: 1px solid #aaa; display: none; z-index: 10; width: 250px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.2);
  }
  .popup input, .popup select { display: block; margin: 5px 0; width: 100%; }
  .overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0,0,0,0.5); z-index: 5;
  }
  th { position: sticky; top: 0; background: #f9f9f9; }
  button { margin-top: 5px; width: 100%; }
</style>
</head>
<body>

<h1>–ñ—É—Ä–Ω–∞–ª –∫–ª–∞—Å—É</h1>

<div class="toolbar">
  –ö–ª–∞—Å: 
  <select id="classSelect" onchange="checkClass()"></select>
  –ü—Ä–µ–¥–º–µ—Ç: 
  <select id="subjectSelect" onchange="buildJournal()"></select>
</div>

<div class="scale-control">
  –ú–∞—Å—à—Ç–∞–±: <input type="range" min="50" max="150" value="100" id="zoomRange" oninput="setZoom(this.value)"> %
</div>

<div id="journalContainer"></div>

<div class="overlay" id="overlay"></div>

<div class="popup" id="popup">
  <h3>üìç –î–æ–¥–∞—Ç–∏ / –ó–º—ñ–Ω–∏—Ç–∏</h3>
  <label>–û—Ü—ñ–Ω–∫–∞:
    <select id="mark"><option value="">‚Äî</option></select>
  </label>
  <label><input type="checkbox" id="absent"> –ù (–≤—ñ–¥—Å—É—Ç–Ω—ñ–π)</label>
  <label>–ö–æ–º–µ–Ω—Ç–∞—Ä: <input type="text" id="comment"></label>
  <button onclick="saveData()">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
  <button onclick="closePopup()">–ó–∞–∫—Ä–∏—Ç–∏</button>
</div>

<div class="choicePopup" id="choicePopup">
  <h3>–í–∏–±–µ—Ä—ñ—Ç—å –¥—ñ—é</h3>
  <button onclick="readComment()">üìñ –ü—Ä–æ—á–∏—Ç–∞—Ç–∏ –∫–æ–º–µ–Ω—Ç–∞—Ä</button>
  <button onclick="editData()">‚úèÔ∏è –ó–º—ñ–Ω–∏—Ç–∏</button>
  <button onclick="closeChoice()">–ó–∞–∫—Ä–∏—Ç–∏</button>
</div>

<script>
let journalData = {};
let commentsStore = {};
let activeCell=null, activeKey=null;

const students=[
  "–ë–æ—Ä–∏—Å –ê–Ω–Ω–∞ –í–∞—Å–∏–ª—ñ–≤–Ω–∞","–ë–æ—Ä–∏—Å –î—ñ–∞–Ω–∞ –í–æ–ª–æ–¥–∏–º–∏—Ä—ñ–≤–Ω–∞","–í–∞—á–∫–æ –Ø—Ä–µ–º–∞ –¢–∞—Ä–∞—Å–æ–≤–∏—á","–í–∞—â–∏—à–∏–Ω –í–µ—Ä–æ–Ω—ñ–∫–∞ –Æ—Ä—ñ—ó–≤–Ω–∞",
  "–ì–æ–ª—É–± –ú–∞–∫—Å–∏–º –ê–Ω–¥—Ä—ñ–π–æ–≤–∏—á","–ì—Ä–∏–Ω—á—É–∫ –ö–∞—Ç–µ—Ä–∏–Ω–∞ –†–æ–º–∞–Ω—ñ–≤–Ω–∞","–ì—Ä–∏–Ω—è–∫ –î–º–∏—Ç—Ä–æ –í–∞—Å–∏–ª—å–æ–≤–∏—á","–ì—É–¥—å –°–≤—è—Ç–æ—Å–ª–∞–≤ –ü–∞–≤–ª–æ–≤–∏—á",
  "–ì—É—Ä—Å—å–∫–∏–π –û—Å—Ç–∞–ø –í–æ–ª–æ–¥–∏–º–∏—Ä–æ–≤–∏—á","–ó–∞–±–∏—Ç—ñ–≤—Å—å–∫–∏–π –í º—è—á–µ—Å–ª–∞–≤ –û–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á","–Ü–≤–∞–Ω—á–∏—à–∏–Ω –û–ª–µ–∫—Å–∞–Ω–¥—Ä –ê–Ω–¥—Ä—ñ–π–æ–≤–∏—á",
  "–Ü–≤–∞–Ω—é–∫ –†–æ–∫—Å–æ–ª–∞–Ω–∞ –Ü–≥–æ—Ä—ñ–≤–Ω–∞","–ö–∞—Ä–≤–∞—Ü—å–∫–∞ –•—Ä–∏—Å—Ç–∏–Ω–∞ –¢–∞—Ä–∞—Å—ñ–≤–Ω–∞","–ö–Ω–∏—à –ê—Ä—ñ–∞–Ω–∞ –ê–Ω–¥—Ä—ñ—ó–≤–Ω–∞","–ö–æ–≤–ª–∏–≥–∞ –ü–∞–≤–ª–æ –†–æ–º–∞–Ω–æ–≤–∏—á",
  "–ö–æ–∑–∞—á—É–∫ –î—ñ–∞–Ω–∞ –†–æ–º–∞–Ω—ñ–≤–Ω–∞","–ö–æ—Ä–æ–ª—å—á—É–∫ –î—ñ–∞–Ω–∞ –Ü–≤–∞–Ω—ñ–≤–Ω–∞","–ö—É–∑—å–º–∞ –û–ª–µ–∫—Å–∞–Ω–¥—Ä –û–ª–µ–≥–æ–≤–∏—á","–ú–∞—Å–∏–∫ –ú–∞–∫—Å–∏–º –Ü–≥–æ—Ä–æ–≤–∏—á",
  "–ú—É–∑–∏–∫–∞ –Æ—Å—Ç–∏–Ω–∞ –û–ª–µ–≥—ñ–≤–Ω–∞","–û–∫—Ä–µ–ø–∫–∏–π –û—Å—Ç–∞–ø –ú–∏–∫–æ–ª–∞–π–æ–≤–∏—á","–û–Ω–∏—Å—å–∫–æ –ú–∞—Ä—Ç–∞ –û–ª–µ—Å—ñ–≤–Ω–∞","–ü—Ä–æ–∫–æ–ø–µ—á–∫–æ –†–æ–º–∞–Ω –¢–∞—Ä–∞—Å–æ–≤–∏—á",
  "–†–µ–∑–µ–∫—É–ª–æ–≤ –í–æ–ª–æ–¥–∏–º–∏—Ä –í–æ–ª–æ–¥–∏–º–∏—Ä–æ–≤–∏—á","–†—É–¥–∏–∫ –î–æ–º—ñ–Ω—ñ–∫–∞ –ú–∏–∫–æ–ª–∞—ó–≤–Ω–∞","–°–∞–ª–∞–º–∞—Ö–∞ –ú–∞—Ä–∫–æ –ù–∞–∑–∞—Ä—ñ–π–æ–≤–∏—á",
  "–°–º–æ–ª–∞ –°–≤—è—Ç–æ—Å–ª–∞–≤ –í–æ–ª–æ–¥–∏–º–∏—Ä–æ–≤–∏—á","–°–ø—ñ–Ω—É–ª –í–µ—Ä–æ–Ω—ñ–∫–∞ –Æ—Ä—ñ—ó–≤–Ω–∞","–°—É—Ö–∞–Ω–æ–≤–∞ –ö–∞—Ä—ñ–Ω–∞ –ê–Ω–¥—Ä—ñ—ó–≤–Ω–∞",
  "–®–µ–≤—á–µ–Ω–∫–æ –î–º–∏—Ç—Ä–æ –Ñ–≤–≥–µ–Ω–æ–≤–∏—á","–®–ø—ñ–∫ –û–ª–µ–≥ –í–æ–ª–æ–¥–∏–º–∏—Ä–æ–≤–∏—á"
];

const subjects = [
  "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ –º–æ–≤–∞","–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ –ª—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∞","–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞","–ê–ª–≥–µ–±—Ä–∞","–ì–µ–æ–º–µ—Ç—Ä—ñ—è",
  "–Ü—Å—Ç–æ—Ä—ñ—è –£–∫—Ä–∞—ó–Ω–∏","–í—Å–µ—Å–≤—ñ—Ç–Ω—è —ñ—Å—Ç–æ—Ä—ñ—è","–ë—ñ–æ–ª–æ–≥—ñ—è","–ì–µ–æ–≥—Ä–∞—Ñ—ñ—è","–§—ñ–∑–∏–∫–∞","–•—ñ–º—ñ—è",
  "–Ü–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞","–ê–Ω–≥–ª—ñ–π—Å—å–∫–∞ –º–æ–≤–∞","–ù—ñ–º–µ—Ü—å–∫–∞ –º–æ–≤–∞","–§—Ä–∞–Ω—Ü—É–∑—å–∫–∞ –º–æ–≤–∞","–§—ñ–∑–∫—É–ª—å—Ç—É—Ä–∞",
  "–¢—Ä—É–¥–æ–≤–µ –Ω–∞–≤—á–∞–Ω–Ω—è","–ú—É–∑–∏—á–Ω–µ –º–∏—Å—Ç–µ—Ü—Ç–≤–æ","–û–±—Ä–∞–∑–æ—Ç–≤–æ—Ä—á–µ –º–∏—Å—Ç–µ—Ü—Ç–≤–æ","–ó–∞—Ä—É–±—ñ–∂–Ω–∞ –ª—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∞",
  "–ü—Ä–∞–≤–æ–∑–Ω–∞–≤—Å—Ç–≤–æ","–ì—Ä–æ–º–∞–¥—è–Ω—Å—å–∫–∞ –æ—Å–≤—ñ—Ç–∞","–ï—Ç–∏–∫–∞","–Ø –¥–æ—Å–ª—ñ–¥–∂—É—é —Å–≤—ñ—Ç"
];

const classSelect = document.getElementById("classSelect");
const subjectSelect = document.getElementById("subjectSelect");
const journalContainer = document.getElementById("journalContainer");

["6-–ê","6-–ë","6-–í","6-–ì","7-–ê","7-–ë","7-–í","7-–ì","8-–ê","8-–ë","8-–í","8-–ì",
 "9-–ê","9-–ë","9-–í","9-–ì","10-–ê","10-–ë","10-–í","10-–ì","11-–ê","11-–ë","11-–í","11-–ì"].forEach(c=>{
  let opt=document.createElement("option"); opt.textContent=c; classSelect.appendChild(opt);
});
subjects.forEach(s=>{ let opt=document.createElement("option"); opt.textContent=s; subjectSelect.appendChild(opt); });

const markSelect = document.getElementById("mark");
for(let i=1;i<=12;i++){ let opt=document.createElement("option"); opt.value=i; opt.textContent=i; markSelect.appendChild(opt); }

const today = new Date();

function setZoom(value){
  document.querySelectorAll(".month-table").forEach(t=>{ t.style.transform = `scale(${value/100})`; });
}

function checkClass(){
  const cls = classSelect.value;
  if(!cls.match(/^[6-9]|10|11/)){
    alert("üîê–°—Ö–æ–∂–µ —Ü–µ–π –∫–ª–∞—Å –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–æ, —Å–ø—Ä–æ–±—É–π—Ç–µ –ø–æ—Ç—ñ–º.");
    journalContainer.innerHTML="";
    return;
  }
  buildJournal();
}

function buildJournal(){
  const cls = classSelect.value;
  const subj = subjectSelect.value;
  const key = cls+"_"+subj;
  if(!journalData[key]) journalData[key]={};

  journalContainer.innerHTML="";

  const daysInMonth = 31; 

  const table = document.createElement("table"); table.className="month-table"; journalContainer.appendChild(table);
  const thead = document.createElement("thead"); table.appendChild(thead);
  const tbody = document.createElement("tbody"); table.appendChild(tbody);

  const headRow = document.createElement("tr");
  const thName = document.createElement("th"); thName.textContent="–£—á–Ω—ñ"; headRow.appendChild(thName);

  for(let d=1; d<=daysInMonth; d++){
    const th = document.createElement("th"); th.textContent=d;
    const cellDate = new Date(today.getFullYear(), today.getMonth(), d);
    if(cellDate.toDateString()===today.toDateString()) th.classList.add("today");
    th.onclick=()=>{ th.classList.toggle("control"); };
    headRow.appendChild(th);
  }
  thead.appendChild(headRow);

  students.forEach((name,i)=>{
    const tr = document.createElement("tr");
    const tdName = document.createElement("td"); tdName.textContent=(i+1)+". "+name; tr.appendChild(tdName);
    for(let d=1; d<=daysInMonth; d++){
      const td = document.createElement("td");
      const dateKey = today.getFullYear()+"-"+("0"+(today.getMonth()+1)).slice(-2)+"-"+("0"+d).slice(-2);
      td.dataset.date=dateKey; td.dataset.student=i;
      td.onclick=()=>cellClick(td,key);
      if(journalData[key][dateKey+"_"+i]) td.innerHTML=journalData[key][dateKey+"_"+i];
      tr.appendChild(td);
    }
    tbody.appendChild(tr);
  });
}

function cellClick(cell,key){
  activeCell=cell; activeKey=key;
  const storageKey = cell.dataset.date+"_"+cell.dataset.student;
  if(commentsStore[activeKey] && commentsStore[activeKey][storageKey]){
    document.getElementById("overlay").style.display="block";
    document.getElementById("choicePopup").style.display="block";
  } else openPopup();
}
function openPopup(){ document.getElementById("overlay").style.display="block"; document.getElementById("popup").style.display="block"; }
function closePopup(){ document.getElementById("overlay").style.display="none"; document.getElementById("popup").style.display="none"; }
function closeChoice(){ document.getElementById("overlay").style.display="none"; document.getElementById("choicePopup").style.display="none"; }
function readComment(){ const storageKey = activeCell.dataset.date+"_"+activeCell.dataset.student; alert("üí≠ –ö–æ–º–µ–Ω—Ç–∞—Ä: "+(commentsStore[activeKey]?.[storageKey] || "–ö–æ–º–µ–Ω—Ç–∞—Ä –≤—ñ–¥—Å—É—Ç–Ω—ñ–π")); closeChoice(); }
function editData(){ closeChoice(); openPopup(); }
function saveData(){
  const mark=document.getElementById("mark").value;
  const comm=document.getElementById("comment").value;
  const absent=document.getElementById("absent").checked;
  let text = absent ? "–ù" : (mark? mark:"");
  if(comm) text+=" üí≠";
  activeCell.innerHTML=text;
  const storageKey = activeCell.dataset.date+"_"+activeCell.dataset.student;
  journalData[activeKey][storageKey]=text;
  if(comm){ if(!commentsStore[activeKey]) commentsStore[activeKey]={}; commentsStore[activeKey][storageKey]=comm; }
  closePopup();
}

window.onload=()=>{
  classSelect.value="6-–ê";
  subjectSelect.value="–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞";
  buildJournal();
};
</script>

</body>
</html>
